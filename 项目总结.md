# 项目总结

## 1. 主要功能

本项目是一个基于大语言模型的AI聊天软件，实现了类似ChatGPT的核心对话功能。主要功能包括：

- **多对话管理**: 用户可以创建多个独立的对话，并在它们之间切换。
- **对话历史**: 所有的对话历史都会被保存，方便用户回顾。
- **实时对话**: 用户可以与AI进行问答，实现实时交互。
- **文件上传**: 在每个对话中，用户可以上传文件，为后续的知识库功能打下基础。
- **基础API**: 后端提供了一套完整的RESTful API，供前端或其他客户端调用，实现了前后端分离。

## 2. 主要技术框架

- **后端**: 
    - **FastAPI**: 一个现代、高性能的Python Web框架，用于构建API。
    - **SQLAlchemy**: 作为ORM（对象关系映射）工具，用于与数据库交互，避免了直接编写SQL语句。
    - **SQLite**: 一个轻量级的本地数据库，用于存储所有对话和文件信息。
    - **Uvicorn**: 作为ASGI服务器，用于运行FastAPI应用。
- **前端**:
    - **Vue.js (v3)**: 一款流行的前端JavaScript框架，用于构建用户界面。
    - **Vite**: 作为前端的构建工具和开发服务器，提供了极快的启动和热更新速度。
    - **Vue Router**: 用于处理前端的路由和页面导航。
    - **Pinia**: 用于Vue应用的状态管理。
    - **Axios**: 用于在前端向后端API发起HTTP请求。

## 3. 目录结构

```
ai_chat/
├── backend/                # 后端代码
│   ├── app/                # FastAPI应用核心代码
│   │   ├── __init__.py
│   │   ├── main.py         # FastAPI 应用入口和中间件配置
│   │   ├── database.py     # 数据库引擎和会话配置
│   │   ├── models.py       # SQLAlchemy 的数据表模型
│   │   ├── schemas.py      # Pydantic 的数据校验模型 (用于API)
│   │   ├── crud.py         # 核心数据库操作函数 (增删改查)
│   │   └── api/            # API路由配置
│   │       └── v1/         # API版本v1
│   │           ├── __init__.py
│   │           ├── api.py  # 聚合所有v1版本的路由
│   │           └── endpoints/
│   │               ├── __init__.py
│   │               └── chats.py # 聊天相关的API端点
│   ├── tests/              # 后端测试目录
│   │   ├── __init__.py
│   │   └── test_main.py    # API的自动化测试脚本
│   ├── uploads/            # 用户上传文件的存储目录
│   └── requirements.txt    # Python依赖包列表
│
└── frontend/               # 前端代码
    ├── src/
    │   ├── assets/         # 静态资源 (CSS, 图片)
    │   ├── components/     # Vue 可复用组件 (如侧边栏)
    │   ├── services/       # 封装的API请求服务
    │   ├── store/          # Pinia 状态管理
    │   ├── views/          # 页面级视图组件
    │   ├── App.vue         # 根组件
    │   ├── main.js         # 前端应用入口
    │   └── router/         # Vue Router 路由配置
    ├── index.html          # 前端主HTML文件
    ├── package.json        # Node.js 依赖和项目脚本
    └── vite.config.js      # Vite 配置文件
```

## 4. 启动方法

### 开发环境

1.  **启动后端服务**:
    - 进入 `ai_chat/backend` 目录。
    - 安装依赖: `pip install -r requirements.txt`
    - 启动服务: `uvicorn app.main:app --host 0.0.0.0 --port 5000 --reload`
    - 服务运行在: `http://localhost:5000`

2.  **启动前端服务**:
    - 进入 `ai_chat/frontend` 目录。
    - 安装依赖: `npm install`
    - 启动服务: `npm run dev`
    - 服务运行在: `http://localhost:5173` (或其他Vite指定的端口)

### 生产环境

1.  **后端**: 在生产环境中，建议使用 Gunicorn + Uvicorn worker 来运行，以获得更好的性能和稳定性。
    ```bash
    gunicorn app.main:app --workers 4 --worker-class uvicorn.workers.UvicornWorker --bind 0.0.0.0:5000
    ```

2.  **前端**: 
    - 在 `ai_chat/frontend` 目录中运行 `npm run build`。
    - 这会在 `ai_chat/frontend/dist` 目录下生成静态文件。
    - 将这些静态文件部署到任何静态文件服务器上 (如 Nginx, Apache, Vercel等)。

## 5. 测试总结报告

- **测试范围**: 对后端API的核心功能进行了自动化测试。
- **测试框架**: 使用 `pytest` 和 FastAPI 的 `TestClient`。
- **测试内容**:
    1.  `test_create_chat`: 测试能否成功创建一个新的对话。
    2.  `test_read_chats`: 测试能否成功读取对话列表。
    3.  `test_create_message`: 测试能否在指定对话中成功发送一条消息。
- **测试结果**: 所有3个测试用例均已成功通过，后端核心功能符合预期。

